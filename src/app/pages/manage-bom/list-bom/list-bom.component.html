<div class="parent-container">
    <!-- <app-menu></app-menu> -->
    <div class="content-container-breadcrumb">
      <app-breadcrumb nz-row [listBreadCrumb]="breadcrumbs"></app-breadcrumb>
    </div>
    <div class="quoting-title">
      <p style="margin-bottom: 0">{{ "QUẢN LÝ BOM" | translate }}</p>
    </div>
    <div class="quoting-header quoting-df quoting-df-jus-between">
      <div class="quoting-header-search"></div>
      <div class="quoting-df quoting-df-jus-between">
        <div
          nz-col
          style="display: flex; align-items: center; padding: 0 12px"
        >
          <button
            style="color: #01aba8"
            nz-button
            nzType="text"
            class="mb-6 quoting-fz-12"
            nz-tooltip="{{ 'Tạo BOM' | translate }}"
            (click)="openPopupCreateOrUpdate()"
          >
            <span
              nz-icon
              nzType="plus-circle"
              nzTheme="outline"
              class="fn-icon-style"
            ></span>
            {{ "Tạo BOM" | translate }}
          </button>
        </div>
      </div>
    </div>
    <div class="quoting-content">
      <div class="quoting-table" #tableBlock [style.width]="widthContent">
        <nz-table
          #expandTable
          [nzData]="listOfMapData"
          nzTableLayout="fixed"
          nzBordered
          [nzSize]="'small'"
          nzShowPagination="false"
          [nzScroll]="{ x: 'auto', y: this.heightTable + 'px' }"
        >
          <thead>
            <tr>
              <ng-container *ngFor="let column of columns; let i = index">
                <ng-container *ngIf="column.localCheck">
                  <th
                    *ngIf="column.isFixed"
                    nz-resizable
                    [nzWidth]="column.width"
                    (nzResize)="onResize($event, i)"
                    [nzAlign]="'center'"
                    nzLeft
                  >
                    <div class="editable-cell">
                      {{ column.keyTitle | translate }}
                      <nz-resize-handle nzDirection="right">
                        <div class="resize-trigger"></div>
                      </nz-resize-handle>
                    </div>
                  </th>
                  <th
                    *ngIf="!column.isFixed"
                    nz-resizable
                    [nzWidth]="column.width"
                    (nzResize)="onResize($event, i)"
                    [nzAlign]="'center'"
                  >
                    <div class="editable-cell">
                      {{ column.keyTitle | translate }}
                      <nz-resize-handle nzDirection="right">
                        <div class="resize-trigger"></div>
                      </nz-resize-handle>
                    </div>
                  </th>
                </ng-container>
              </ng-container>
              <th nzWidth="100px" nzAlign="center" nzRight>
                {{ "Thao tác" | translate }}
              </th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let data of expandTable.data; let j = index">
              <ng-container
                *ngFor="let item of mapOfExpandedData[data.key]; let k = index"
              >
                <tr *ngIf="(item.parent && item.parent.expand) || !item.parent">
                  <ng-container *ngFor="let col of columns; let i = index">
                    <ng-container *ngIf="col.localCheck">
                      <ng-container *ngIf="i == 0">
                        <td
                          [nzIndentSize]="item.level! * 20"
                          [nzShowExpand]="!!item.children"
                          [(nzExpand)]="item.expand"
                          (nzExpandChange)="
                            getChildren(
                              mapOfExpandedData[item.key],
                              item,
                              j,
                              k,
                              $event
                            )
                          "
                        >
                          {{ item[col.keyName] }}
                        </td>
                      </ng-container>
                      <ng-container *ngIf="i != 0">
                        <ng-container *ngIf="col.dataType == dataType.NUMBER || col.dataType == dataType.DATE_TIME">
                            <td class="quoting-text-align-right">{{ item[col.keyName] }}</td>
                        </ng-container>
                        <ng-container *ngIf="col.dataType != dataType.NUMBER && col.dataType != dataType.DATE_TIME">
                            <td>{{ item[col.keyName] }}</td>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                  </ng-container>
                  <td nzRight>
                    <div class="quoting-df-jus-evenly quoting-df">
                      <button
                        nz-button
                        nzType="link"
                        nz-tooltip="{{ 'btn.edit' | translate }}"
                      >
                        <img src="./assets/icons/Edit-VNT.svg" />
                      </button>
                      <button
                        nz-button
                        nzType="link"
                        nz-tooltip="{{ 'btn.delete' | translate }}"
                        (click)="openPopupDelete(data)"
                      >
                        <img
                          width="16px"
                          height="16px"
                          src="./assets/icons/Delete-VNT.svg"
                        />
                      </button>
                    </div>
                  </td>
                </tr>
              </ng-container>
            </ng-container>
          </tbody>
        </nz-table>
        <app-pagination
          *ngIf="total"
          [currentPage]="pageNumber"
          [currentSize]="pageSize"
          [total]="total"
          (emitPage)="getData($event)"
        >
        </app-pagination>
      </div>
    </div>
  </div>
  <app-popup-create-or-update-bom *ngIf="isvisiblePopupCreateOrUpdate" [(isvisible)]="isvisiblePopupCreateOrUpdate">
  </app-popup-create-or-update-bom>
  